<!DOCTYPE html>
<html>
<head>
<base target="_top">
<script>
function loadExpenses() {
google.script.run.withSuccessHandler(renderExpenses).getExpenses();
}

function renderExpenses(expenses) {
var table = document.getElementById('expenseTable');
table.innerHTML = '';

expenses.forEach(function(expense) {
var row = table.insertRow();
row.insertCell(0).innerText = expense[0];
row.insertCell(1).innerText = expense[1];
row.insertCell(2).innerText = expense[2];
row.insertCell(3).innerText = expense[3];
});
}

function addExpense() {
var date = document.getElementById('date').value;
var description = document.getElementById('description').value;
var amount = document.getElementById('amount').value;
var category = document.getElementById('category').value;

google.script.run.withSuccessHandler(function(response) {
alert(response);
loadExpenses(); // Reload expenses after adding
}).addExpense(date, description, amount, category);
}
</script>
</head>
<body onload="loadExpenses()">
<h2>Monthly Expenses</h2>
<form id="expenseForm" onsubmit="event.preventDefault(); addExpense();">
<label for="date">Date:</label>
<input type="date" id="date" required><br><br>

<label for="description">Description:</label>
<input type="text" id="description" required><br><br>
<label for="amount">Amount:</label>
<input type="number" id="amount" required><br><br>
<label for="category">Category:</label>
<input type="text" id="category" required><br><br>
<input type="submit" value="Add Expense">
</form>

<h3>Expense List</h3>
<table border="1" id="expenseTable">
<tr>
<th>Date</th>
<th>Description</th>
<th>Amount</th>
<th>Category</th>
</tr>
</table>
</body>
</html>
